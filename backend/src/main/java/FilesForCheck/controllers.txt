Balíček (složka): controllers
Cesta: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers

Seznam souborů:
AppUserController.java
AuthController.java
CurrentPlayerController.java
DebugController.java
MatchController.java
MatchRegistrationController.java
PlayerController.java
PlayerInactivityPeriodController.java
SeasonController.java
TestController.java
TestEmailController.java
TestSmsController.java



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\AppUserController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.AppUserDTO;
import cz.phsoft.hokej.models.dto.ChangePasswordDTO;
import cz.phsoft.hokej.models.services.AppUserService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro sprĂˇvu uĹľivatelskĂ˝ch ĂşÄŤtĹŻ.
 * <p>
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>prĂˇci s pĹ™ihlĂˇĹˇenĂ˝m uĹľivatelem (profil, zmÄ›na hesla),</li>
 *     <li>administrativnĂ­ sprĂˇvu uĹľivatelĹŻ (pouze ADMIN).</li>
 * </ul>
 * <p>
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link AppUserService}.
 */
@RestController
@RequestMapping("/api/users")
public class AppUserController {

    private final AppUserService appUserService;

    public AppUserController(AppUserService appUserService) {
        this.appUserService = appUserService;
    }

    /**
     * VrĂˇtĂ­ detail aktuĂˇlnÄ› pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     * <p>
     * Identifikace uĹľivatele probĂ­hĂˇ pomocĂ­ e-mailu (username)
     * zĂ­skanĂ©ho z {@link Authentication}.
     *
     * @param authentication objekt s informacemi o pĹ™ihlĂˇĹˇenĂ©m uĹľivateli
     * @return detail pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele
     */
    @GetMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public AppUserDTO getCurrentUser(Authentication authentication) {
        return appUserService.getCurrentUser(authentication.getName());
    }

    /**
     * Aktualizuje Ăşdaje aktuĂˇlnÄ› pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     *
     * @param authentication objekt s informacemi o pĹ™ihlĂˇĹˇenĂ©m uĹľivateli
     * @param dto            aktualizovanĂˇ data uĹľivatele
     * @return informace o ĂşspÄ›ĹˇnĂ© aktualizaci
     */
    @PutMapping("/me/update")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<String> updateUser(
            Authentication authentication,
            @Valid @RequestBody AppUserDTO dto) {

        String email = authentication.getName();
        appUserService.updateUser(email, dto);
        return ResponseEntity.ok("UĹľivatel byl zmÄ›nÄ›n");
    }

    /**
     * ZmÄ›nĂ­ heslo aktuĂˇlnÄ› pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     *
     * @param authentication objekt s informacemi o pĹ™ihlĂˇĹˇenĂ©m uĹľivateli
     * @param dto            DTO obsahujĂ­cĂ­ starĂ© a novĂ© heslo
     * @return informace o ĂşspÄ›ĹˇnĂ©m provedenĂ­ zmÄ›ny
     */
    @PostMapping("/me/change-password")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<String> changePassword(
            Authentication authentication,
            @Valid @RequestBody ChangePasswordDTO dto) {

        String email = authentication.getName();
        appUserService.changePassword(
                email,
                dto.getOldPassword(),
                dto.getNewPassword(),
                dto.getNewPasswordConfirm()
        );
        return ResponseEntity.ok("Heslo ĂşspÄ›ĹˇnÄ› zmÄ›nÄ›no");
    }

    //ADMIN
    /**
     * VrĂˇtĂ­ seznam vĹˇech uĹľivatelĹŻ v systĂ©mu.
     * <p>
     * Endpoint je dostupnĂ˝ pouze pro administrĂˇtora.
     *
     * @return seznam uĹľivatelĹŻ
     */
    @GetMapping
    @PreAuthorize("hasRole('ADMIN')")
    public List<AppUserDTO> getAllUsers() {
        return appUserService.getAllUsers();
    }

    // TODO - NOVĂť ENDPOINT
    @GetMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public AppUserDTO getUserById(@PathVariable Long id ) {
        return appUserService.getUserById(id);
    }

    /**
     * Resetuje heslo uĹľivatele na vĂ˝chozĂ­ hodnotu.
     * <p>
     * Operace je vyhrazena pouze pro administrĂˇtora.
     *
     * @param id ID uĹľivatele
     * @return informace o ĂşspÄ›ĹˇnĂ©m resetu hesla
     */
    @PostMapping("/{id}/reset-password")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<String> resetPassword(@PathVariable Long id) {
        appUserService.resetPassword(id);
        return ResponseEntity.ok("Heslo resetovĂˇno na 'Player123'");
    }

    /**
     * Aktivuje ĂşÄŤet uĹľivatele.
     * <p>
     * Endpoint je dostupnĂ˝ pouze pro administrĂˇtora.
     */
    @PatchMapping("/{id}/activate")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<String> activateUserByAdmin(@PathVariable Long id) {
        appUserService.activateUserByAdmin(id);
        return ResponseEntity.ok("UĹľivatel byl ĂşspÄ›ĹˇnÄ› aktivovĂˇn");
    }

    /**
     * Dektivuje ĂşÄŤet uĹľivatele.
     * <p>
     * Endpoint je dostupnĂ˝ pouze pro administrĂˇtora.
     */
    @PatchMapping("/{id}/deactivate")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<String> deactivateUserByAdmin(@PathVariable Long id) {
        appUserService.deactivateUserByAdmin(id);
        return ResponseEntity.ok("UĹľivatel byl ĂşspÄ›ĹˇnÄ› deaktivovĂˇn");
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\AuthController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.AppUserDTO;
import cz.phsoft.hokej.models.dto.RegisterUserDTO;
import cz.phsoft.hokej.models.services.AppUserService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

/**
 * REST controller pro autentizaci a registraci uĹľivatelĹŻ.
 * <p>
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>registraci novĂ˝ch uĹľivatelĹŻ,</li>
 *     <li>aktivaci uĹľivatelskĂ©ho ĂşÄŤtu pomocĂ­ ovÄ›Ĺ™ovacĂ­ho tokenu,</li>
 *     <li>zĂ­skĂˇnĂ­ informacĂ­ o aktuĂˇlnÄ› pĹ™ihlĂˇĹˇenĂ©m uĹľivateli.</li>
 * </ul>
 *
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link AppUserService}.
 */
@RestController
@RequestMapping("/api/auth")
public class AuthController {

    private final AppUserService appUserService;

    public AuthController(AppUserService appUserService) {
        this.appUserService = appUserService;
    }

    /**
     * Zaregistruje novĂ©ho uĹľivatele.
     * <p>
     * Po ĂşspÄ›ĹˇnĂ© registraci je uĹľivateli odeslĂˇn aktivaÄŤnĂ­ e-mail
     * s ovÄ›Ĺ™ovacĂ­m odkazem.
     *
     * @param dto registraÄŤnĂ­ Ăşdaje uĹľivatele
     * @return informace o ĂşspÄ›ĹˇnĂ©m pĹ™ijetĂ­ registrace
     */
    @PostMapping("/register")
    public ResponseEntity<?> register(@Valid @RequestBody RegisterUserDTO dto) {
        appUserService.register(dto);
        return ResponseEntity.ok(
                Map.of(
                        "status", "ok",
                        "message", "Registrace ĂşspÄ›ĹˇnĂˇ. Zkontrolujte email pro aktivaci ĂşÄŤtu."
                )
        );
    }

    /**
     * VrĂˇtĂ­ informace o aktuĂˇlnÄ› pĹ™ihlĂˇĹˇenĂ©m uĹľivateli.
     *
     * @param authentication objekt s informacemi o pĹ™ihlĂˇĹˇenĂ©m uĹľivateli
     * @return detail pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele
     */
    @GetMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<AppUserDTO> getCurrentUser(Authentication authentication) {
        AppUserDTO dto = appUserService.getCurrentUser(authentication.getName());
        return ResponseEntity.ok(dto);
    }

    /**
     * Aktivuje uĹľivatelskĂ˝ ĂşÄŤet na zĂˇkladÄ› ovÄ›Ĺ™ovacĂ­ho tokenu.
     * <p>
     * Token je zaslĂˇn uĹľivateli e-mailem po registraci a mĂˇ omezenou platnost.
     *
     * @param token aktivaÄŤnĂ­ token
     * @return vĂ˝sledek aktivace ĂşÄŤtu
     */
    @GetMapping("/verify")
    public ResponseEntity<String> verifyEmail(@RequestParam String token) {
        boolean activated = appUserService.activateUser(token);

        if (!activated) {
            // sjednocenĂˇ odpovÄ›ÄŹ pro neplatnĂ˝ nebo expirovanĂ˝ token
            return ResponseEntity
                    .badRequest()
                    .body("NeplatnĂ˝ nebo expirovanĂ˝ aktivaÄŤnĂ­ odkaz.");
        }

        return ResponseEntity.ok("ĂšÄŤet byl ĂşspÄ›ĹˇnÄ› aktivovĂˇn.");
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\CurrentPlayerController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.PlayerDTO;
import cz.phsoft.hokej.models.dto.SuccessResponseDTO;
import cz.phsoft.hokej.models.services.PlayerService;
import cz.phsoft.hokej.models.services.CurrentPlayerService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro prĂˇci s â€žaktuĂˇlnĂ­m hrĂˇÄŤemâ€ś pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
 * <p>
 * AktuĂˇlnĂ­ hrĂˇÄŤ pĹ™edstavuje kontext, ve kterĂ©m uĹľivatel pracuje
 * (napĹ™. registrace na zĂˇpasy, zobrazenĂ­ statistik apod.).
 * <p>
 * Controller umoĹľĹuje:
 * <ul>
 *     <li>ruÄŤnĂ­ nastavenĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe,</li>
 *     <li>automatickĂ˝ vĂ˝bÄ›r aktuĂˇlnĂ­ho hrĂˇÄŤe po pĹ™ihlĂˇĹˇenĂ­,</li>
 *     <li>zĂ­skĂˇnĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe,</li>
 *     <li>zĂ­skĂˇnĂ­ seznamu hrĂˇÄŤĹŻ pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.</li>
 * </ul>
 *
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link PlayerService}
 * a {@link CurrentPlayerService}.
 */
@RestController
@RequestMapping("/api/current-player")
public class CurrentPlayerController {

    private final CurrentPlayerService currentPlayerService;
    private final PlayerService playerService;

    public CurrentPlayerController(CurrentPlayerService currentPlayerService,
                                   PlayerService playerService) {
        this.currentPlayerService = currentPlayerService;
        this.playerService = playerService;
    }

    /**
     * NastavĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     * <p>
     * PouĹľĂ­vĂˇ se zejmĂ©na v pĹ™Ă­padech, kdy mĂˇ uĹľivatel
     * pĹ™iĹ™azeno vĂ­ce hrĂˇÄŤĹŻ a chce mezi nimi ruÄŤnÄ› pĹ™epĂ­nat.
     *
     * @param playerId ID hrĂˇÄŤe, kterĂ˝ mĂˇ bĂ˝t nastaven jako aktuĂˇlnĂ­
     * @param auth     autentizaÄŤnĂ­ kontext pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele
     * @return informace o ĂşspÄ›ĹˇnĂ©m nastavenĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe
     */
    @PostMapping("/{playerId}")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<SuccessResponseDTO> setCurrentPlayer(
            @PathVariable Long playerId,
            Authentication auth) {

        SuccessResponseDTO response =
                playerService.setCurrentPlayerForUser(auth.getName(), playerId);

        return ResponseEntity.ok(response);
    }

    /**
     * Automaticky zvolĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     * <p>
     * Typicky se volĂˇ po pĹ™ihlĂˇĹˇenĂ­ uĹľivatele:
     * <ul>
     *     <li>pokud mĂˇ uĹľivatel prĂˇvÄ› jednoho hrĂˇÄŤe, je vybrĂˇn automaticky,</li>
     *     <li>pokud mĂˇ vĂ­ce hrĂˇÄŤĹŻ, vĂ˝bÄ›r zĂˇvisĂ­ na pravidlech ve service vrstvÄ›.</li>
     * </ul>
     *
     * @param auth autentizaÄŤnĂ­ kontext pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele
     * @return informace o vĂ˝sledku automatickĂ©ho vĂ˝bÄ›ru
     */
    @PostMapping("/auto-select")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<SuccessResponseDTO> autoSelectCurrentPlayer(Authentication auth) {

        SuccessResponseDTO response =
                playerService.autoSelectCurrentPlayerForUser(auth.getName());

        return ResponseEntity.ok(response);
    }

    /**
     * VrĂˇtĂ­ aktuĂˇlnÄ› zvolenĂ©ho hrĂˇÄŤe pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     * <p>
     * Pokud uĹľivatel nemĂˇ aktuĂˇlnĂ­ho hrĂˇÄŤe nastavenĂ©ho,
     * je vrĂˇcena hodnota {@code null}.
     *
     * @return aktuĂˇlnĂ­ hrĂˇÄŤ nebo {@code null}, pokud nenĂ­ nastaven
     */
    @GetMapping
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<PlayerDTO> getCurrentPlayer() {

        Long playerId = currentPlayerService.getCurrentPlayerId();
        if (playerId == null) {
            return ResponseEntity.ok(null);
        }

        PlayerDTO player = playerService.getPlayerById(playerId);
        return ResponseEntity.ok(player);
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\DebugController.java
-----

package cz.phsoft.hokej.controllers;

import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

/**
 * Debug controller pro ĂşÄŤely vĂ˝voje a ladÄ›nĂ­ bezpeÄŤnostnĂ­ho kontextu.
 * <p>
 * SlouĹľĂ­ k ovÄ›Ĺ™enĂ­:
 * <ul>
 *     <li>zda je uĹľivatel autentizovĂˇn,</li>
 *     <li>jakĂ© Ăşdaje jsou dostupnĂ© v {@link Authentication},</li>
 *     <li>jakĂ© role a authority mĂˇ aktuĂˇlnĂ­ uĹľivatel.</li>
 * </ul>
 *
 * Tento controller by mÄ›l bĂ˝t pouĹľĂ­vĂˇn pouze ve vĂ˝vojovĂ©m prostĹ™edĂ­
 * a nemÄ›l by bĂ˝t dostupnĂ˝ v produkci.
 */
@RestController
public class DebugController {

    /**
     * VrĂˇtĂ­ aktuĂˇlnĂ­ {@link Authentication} objekt.
     * <p>
     * Endpoint slouĹľĂ­ vĂ˝hradnÄ› pro ladÄ›nĂ­ a diagnostiku.
     *
     * @param auth autentizaÄŤnĂ­ kontext aktuĂˇlnĂ­ho uĹľivatele
     * @return objekt {@link Authentication}
     */
    @GetMapping("/api/debug/me")
    public Object me(Authentication auth) {
        return auth;
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\MatchController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.data.enums.MatchCancelReason;
import cz.phsoft.hokej.models.dto.MatchDTO;
import cz.phsoft.hokej.models.dto.MatchDetailDTO;
import cz.phsoft.hokej.models.dto.MatchOverviewDTO;
import cz.phsoft.hokej.models.dto.SuccessResponseDTO;
import cz.phsoft.hokej.models.services.CurrentPlayerService;
import cz.phsoft.hokej.models.services.MatchService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro prĂˇci se zĂˇpasy.
 *
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>administraci zĂˇpasĹŻ (CRUD, zruĹˇenĂ­ / obnovenĂ­) pro role ADMIN/MANAGER,</li>
 *     <li>pohled na zĂˇpasy z perspektivy aktuĂˇlnĂ­ho hrĂˇÄŤe,</li>
 *     <li>detail zĂˇpasu vÄŤetnÄ› stavĹŻ registracĂ­ pro aktuĂˇlnĂ­ho hrĂˇÄŤe.</li>
 * </ul>
 *
 * Business logika je delegovĂˇna do {@link MatchService}.
 */
@RestController
@RequestMapping("/api/matches")
public class MatchController {

    private final MatchService matchService;
    private final CurrentPlayerService currentPlayerService;

    public MatchController(MatchService matchService,
                           CurrentPlayerService currentPlayerService) {
        this.matchService = matchService;
        this.currentPlayerService = currentPlayerService;
    }

    // =========================================================
    //  ADMIN / MANAGER â€“ GLOBĂLNĂŤ SPRĂVA ZĂPASĹ®
    // =========================================================

    /**
     * VrĂˇtĂ­ seznam vĹˇech zĂˇpasĹŻ v systĂ©mu.
     */
    @GetMapping
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchDTO> getAllMatches() {
        return matchService.getAllMatches();
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech nadchĂˇzejĂ­cĂ­ch zĂˇpasĹŻ.
     */
    @GetMapping("/upcoming")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchDTO> getUpcomingMatches() {
        return matchService.getUpcomingMatches();
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech jiĹľ odehranĂ˝ch (minulĂ˝ch) zĂˇpasĹŻ.
     */
    @GetMapping("/past")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchDTO> getPastMatches() {
        return matchService.getPastMatches();
    }

    /**
     * VytvoĹ™Ă­ novĂ˝ zĂˇpas.
     *
     * @param matchDTO data novĂ©ho zĂˇpasu
     * @return vytvoĹ™enĂ˝ zĂˇpas
     */
    @PostMapping
    @PreAuthorize("hasRole('ADMIN')")
    public MatchDTO createMatch(@Valid @RequestBody MatchDTO matchDTO) {
        return matchService.createMatch(matchDTO);
    }

    /**
     * VrĂˇtĂ­ zĂˇkladnĂ­ detail zĂˇpasu podle jeho ID
     * (admin / manager pohled â€“ DTO bez hrĂˇÄŤskĂ©ho kontextu).
     */
    @GetMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public MatchDTO getMatch(@PathVariable Long id) {
        return matchService.getMatchById(id);
    }

    /**
     * Aktualizuje existujĂ­cĂ­ zĂˇpas.
     *
     * @param id  ID zĂˇpasu
     * @param dto aktualizovanĂˇ data zĂˇpasu
     */
    @PutMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public MatchDTO updateMatch(@PathVariable Long id,
                                @Valid @RequestBody MatchDTO dto) {
        return matchService.updateMatch(id, dto);
    }

    /**
     * OdstranĂ­ zĂˇpas ze systĂ©mu.
     *
     * Operace je vyhrazena pouze pro administrĂˇtora.
     */
    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SuccessResponseDTO> deleteMatch(@PathVariable Long id) {
        SuccessResponseDTO response = matchService.deleteMatch(id);
        return ResponseEntity.ok(response);
    }

    /**
     * VrĂˇtĂ­ seznam zĂˇpasĹŻ, kterĂ© jsou dostupnĂ© pro konkrĂ©tnĂ­ho hrĂˇÄŤe.
     *
     * @param playerId ID hrĂˇÄŤe
     */
    @GetMapping("/available-for-player/{playerId}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchDTO> getAvailableMatchesForPlayer(@PathVariable Long playerId) {
        return matchService.getAvailableMatchesForPlayer(playerId);
    }

    /**
     * ZruĹˇĂ­ zĂˇpas a uloĹľĂ­ dĹŻvod zruĹˇenĂ­.
     *
     * @param matchId ID zĂˇpasu
     * @param reason  dĹŻvod zruĹˇenĂ­ zĂˇpasu
     */
    @PatchMapping("/{matchId}/cancel")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public ResponseEntity<SuccessResponseDTO> cancelMatch(
            @PathVariable Long matchId,
            @RequestParam MatchCancelReason reason
    ) {
        SuccessResponseDTO response = matchService.cancelMatch(matchId, reason);
        return ResponseEntity.ok(response);
    }

    /**
     * ObnovĂ­ dĹ™Ă­ve zruĹˇenĂ˝ zĂˇpas.
     *
     * @param matchId ID zĂˇpasu
     */
    @PatchMapping("/{matchId}/uncancel")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public ResponseEntity<SuccessResponseDTO> unCancelMatch(@PathVariable Long matchId) {
        SuccessResponseDTO response = matchService.unCancelMatch(matchId);
        return ResponseEntity.ok(response);
    }

    // =========================================================
    //  HRĂÄŚ â€“ ENDPOINTY V KONTEXTU AKTUĂLNĂŤHO PLAYERA
    // =========================================================

    /**
     * VrĂˇtĂ­ detail konkrĂ©tnĂ­ho zĂˇpasu z pohledu hrĂˇÄŤe
     * (vÄŤetnÄ› stavu registracĂ­, prĂˇv, atd.).
     *
     * ZmÄ›nil jsem URL na /{id}/detail kvĹŻli konzistenci s ostatnĂ­mi
     * endpointy; pokud potĹ™ebujeĹˇ zachovat /matchDetail/{id},
     * mĹŻĹľeĹˇ pĹ™idat alias.
     */
    @GetMapping("/{id}/detail")
    @PreAuthorize("isAuthenticated()")
    public MatchDetailDTO getMatchDetail(@PathVariable Long id) {
        return matchService.getMatchDetail(id);
    }

    // VolitelnĂ˝ alias pro zpÄ›tnou kompatibilitu:
    // @GetMapping("/matchDetail/{id}")
    // public MatchDetailDTO getMatchDetailAlias(@PathVariable Long id) {
    //     return getMatchDetail(id);
    // }

    /**
     * VrĂˇtĂ­ nejbliĹľĹˇĂ­ nadchĂˇzejĂ­cĂ­ zĂˇpas (globĂˇlnÄ›).
     */
    @GetMapping("/next")
    @PreAuthorize("isAuthenticated()")
    public MatchDTO getNextMatch() {
        return matchService.getNextMatch();
    }

    /**
     * VrĂˇtĂ­ seznam nadchĂˇzejĂ­cĂ­ch zĂˇpasĹŻ pro aktuĂˇlnÄ› zvolenĂ©ho hrĂˇÄŤe.
     */
    @GetMapping("/me/upcoming")
    @PreAuthorize("isAuthenticated()")
    public List<MatchDTO> getUpcomingMatchesForMe(Authentication authentication) {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();
        return matchService.getUpcomingMatchesForPlayer(currentPlayerId);
    }

    /**
     * VrĂˇtĂ­ pĹ™ehled nadchĂˇzejĂ­cĂ­ch zĂˇpasĹŻ pro aktuĂˇlnĂ­ho hrĂˇÄŤe.
     */
    @GetMapping("/me/upcoming-overview")
    @PreAuthorize("isAuthenticated()")
    public List<MatchOverviewDTO> getUpcomingMatchesOverviewForMe(Authentication authentication) {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();
        return matchService.getUpcomingMatchesOverviewForPlayer(currentPlayerId);
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech jiĹľ odehranĂ˝ch zĂˇpasĹŻ pro aktuĂˇlnĂ­ho hrĂˇÄŤe.
     */
    @GetMapping("/me/all-passed")
    @PreAuthorize("isAuthenticated()")
    public List<MatchOverviewDTO> getAllMatchesForPlayer(Authentication authentication) {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();
        return matchService.getAllPassedMatchesForPlayer(currentPlayerId);
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\MatchRegistrationController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.exceptions.CurrentPlayerNotSelectedException;
import cz.phsoft.hokej.models.dto.MatchRegistrationDTO;
import cz.phsoft.hokej.models.dto.PlayerDTO;
import cz.phsoft.hokej.models.dto.requests.MatchRegistrationRequest;
import cz.phsoft.hokej.models.services.CurrentPlayerService;
import cz.phsoft.hokej.models.services.MatchRegistrationService;
import cz.phsoft.hokej.models.services.MatchService;
import jakarta.validation.Valid;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro sprĂˇvu registracĂ­ hrĂˇÄŤĹŻ na zĂˇpasy.
 *
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>administraci registracĂ­ (ADMIN / MANAGER),</li>
 *     <li>sprĂˇvu registracĂ­ aktuĂˇlnĂ­ho hrĂˇÄŤe (/me).</li>
 * </ul>
 *
 * Business logika je delegovĂˇna do {@link MatchRegistrationService}
 * a ÄŤĂˇsteÄŤnÄ› do {@link MatchService}.
 */
@RestController
@RequestMapping("/api/registrations")
public class MatchRegistrationController {

    private final MatchRegistrationService matchRegistrationService;
    private final CurrentPlayerService currentPlayerService;
    private final MatchService matchService;

    public MatchRegistrationController(MatchRegistrationService matchRegistrationService,
                                       CurrentPlayerService currentPlayerService,
                                       MatchService matchService) {
        this.matchRegistrationService = matchRegistrationService;
        this.currentPlayerService = currentPlayerService;
        this.matchService = matchService;
    }

    // =========================================================
    //  ADMIN / MANAGER â€“ GLOBĂLNĂŤ SPRĂVA REGISTRACĂŤ
    // =========================================================

    /**
     * VrĂˇtĂ­ vĹˇechny registrace vĹˇech hrĂˇÄŤĹŻ na vĹˇechny zĂˇpasy.
     */
    @GetMapping
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchRegistrationDTO> getAllRegistrations() {
        return matchRegistrationService.getAllRegistrations();
    }

    /**
     * VrĂˇtĂ­ vĹˇechny registrace hrĂˇÄŤĹŻ pro konkrĂ©tnĂ­ zĂˇpas.
     *
     * @param matchId ID zĂˇpasu
     */
    @GetMapping("/match/{matchId}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchRegistrationDTO> getRegistrationsForMatch(@PathVariable Long matchId) {
        return matchRegistrationService.getRegistrationsForMatch(matchId);
    }

    /**
     * VrĂˇtĂ­ vĹˇechny registrace konkrĂ©tnĂ­ho hrĂˇÄŤe napĹ™Ă­ÄŤ zĂˇpasy.
     *
     * @param playerId ID hrĂˇÄŤe
     */
    @GetMapping("/player/{playerId}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<MatchRegistrationDTO> getRegistrationsForPlayer(@PathVariable Long playerId) {
        return matchRegistrationService.getRegistrationsForPlayer(playerId);
    }

    /**
     * VrĂˇtĂ­ seznam hrĂˇÄŤĹŻ, kteĹ™Ă­ na pozvĂˇnku k danĂ©mu zĂˇpasu
     * zatĂ­m vĹŻbec nereagovali (ĹľĂˇdnĂˇ registrace ani omluva).
     *
     * @param matchId ID zĂˇpasu
     */
    @GetMapping("/match/{matchId}/no-response")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<PlayerDTO> getNoResponsePlayers(@PathVariable Long matchId) {
        return matchRegistrationService.getNoResponsePlayers(matchId);
    }

    /**
     * UniverzĂˇlnĂ­ endpoint pro vytvoĹ™enĂ­ nebo aktualizaci registrace
     * za konkrĂ©tnĂ­ho hrĂˇÄŤe (ADMIN / MANAGER).
     *
     * @param playerId ID hrĂˇÄŤe, za kterĂ©ho se zmÄ›na provĂˇdĂ­
     * @param request  poĹľadavek na zmÄ›nu registrace
     */
    @PostMapping("/upsert/{playerId}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public MatchRegistrationDTO upsertForPlayer(
            @PathVariable Long playerId,
            @Valid @RequestBody MatchRegistrationRequest request
    ) {
        return matchRegistrationService.upsertRegistration(playerId, request);
    }

    /**
     * OznaÄŤĂ­ hrĂˇÄŤe v konkrĂ©tnĂ­m zĂˇpase jako neomluvenÄ› nepĹ™Ă­tomnĂ©ho.
     *
     * @param matchId   ID zĂˇpasu
     * @param playerId  ID hrĂˇÄŤe
     * @param adminNote volitelnĂˇ poznĂˇmka administrĂˇtora
     */
    @PatchMapping("/match/{matchId}/players/{playerId}/no-excused")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public MatchRegistrationDTO markNoExcused(
            @PathVariable Long matchId,
            @PathVariable Long playerId,
            @RequestParam(required = false) String adminNote
    ) {
        return matchService.markNoExcused(matchId, playerId, adminNote);
    }

    // =========================================================
    //  USER â€“ REGISTRACE AKTUĂLNĂŤHO HRĂÄŚE (/me)
    // =========================================================

    /**
     * UniverzĂˇlnĂ­ endpoint pro sprĂˇvu registrace aktuĂˇlnĂ­ho hrĂˇÄŤe na zĂˇpas.
     *
     * Pracuje automaticky s aktuĂˇlnÄ› zvolenĂ˝m hrĂˇÄŤem.
     */
    @PostMapping("/me/upsert")
    @PreAuthorize("isAuthenticated()")
    public MatchRegistrationDTO upsertForCurrentPlayer(
            @Valid @RequestBody MatchRegistrationRequest request
    ) {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();

        if (currentPlayerId == null) {
            throw new CurrentPlayerNotSelectedException();
        }

        return matchRegistrationService.upsertRegistration(currentPlayerId, request);
    }

    /**
     * VrĂˇtĂ­ vĹˇechny registrace aktuĂˇlnÄ› zvolenĂ©ho hrĂˇÄŤe.
     */
    @GetMapping("/me/for-current-player")
    @PreAuthorize("isAuthenticated()")
    public List<MatchRegistrationDTO> getRegistrationsForCurrentPlayer() {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();
        return matchRegistrationService.getRegistrationsForPlayer(currentPlayerId);
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\PlayerController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.PlayerDTO;
import cz.phsoft.hokej.models.dto.SuccessResponseDTO;
import cz.phsoft.hokej.models.dto.requests.ChangePlayerUserRequest;
import cz.phsoft.hokej.models.services.CurrentPlayerService;
import cz.phsoft.hokej.models.services.PlayerService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro sprĂˇvu hrĂˇÄŤĹŻ.
 *
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>administraci hrĂˇÄŤĹŻ (CRUD, schvĂˇlenĂ­ / zamĂ­tnutĂ­, zmÄ›na uĹľivatele) pro role ADMIN/MANAGER,</li>
 *     <li>sprĂˇvu hrĂˇÄŤĹŻ z pohledu pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele (moji hrĂˇÄŤi /me).</li>
 * </ul>
 *
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link PlayerService}.
 */
@RestController
@RequestMapping("/api/players")
public class PlayerController {

    private final PlayerService playerService;
    private final CurrentPlayerService currentPlayerService;

    public PlayerController(PlayerService playerService,
                            CurrentPlayerService currentPlayerService) {
        this.playerService = playerService;
        this.currentPlayerService = currentPlayerService;
    }

    // =========================================================
    //  ADMIN / MANAGER â€“ GLOBĂLNĂŤ SPRĂVA HRĂÄŚĹ®
    // =========================================================

    /**
     * VrĂˇtĂ­ seznam vĹˇech hrĂˇÄŤĹŻ v systĂ©mu.
     */
    @GetMapping
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<PlayerDTO> getAllPlayers() {
        return playerService.getAllPlayers();
    }

    /**
     * VrĂˇtĂ­ detail hrĂˇÄŤe podle jeho ID.
     *
     * @param id ID hrĂˇÄŤe
     */
    @GetMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public PlayerDTO getPlayerById(@PathVariable Long id) {
        return playerService.getPlayerById(id);
    }

    /**
     * VytvoĹ™Ă­ novĂ©ho hrĂˇÄŤe (administrĂˇtor/manaĹľer).
     *
     * PouĹľĂ­vĂˇ se pĹ™i ruÄŤnĂ­m zaklĂˇdĂˇnĂ­ hrĂˇÄŤe do systĂ©mu.
     */
    @PostMapping
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public PlayerDTO createPlayer(@Valid @RequestBody PlayerDTO playerDTO) {
        return playerService.createPlayer(playerDTO);
    }

    /**
     * Aktualizuje Ăşdaje hrĂˇÄŤe administrĂˇtorem.
     *
     * @param id  ID hrĂˇÄŤe
     * @param dto aktualizovanĂˇ data hrĂˇÄŤe
     */
    @PutMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public PlayerDTO updatePlayerAdmin(@PathVariable Long id,
                                       @Valid @RequestBody PlayerDTO dto) {
        return playerService.updatePlayer(id, dto);
    }

    /**
     * OdstranĂ­ hrĂˇÄŤe ze systĂ©mu.
     *
     * Operace je vyhrazena pouze pro administrĂˇtora.
     */
    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SuccessResponseDTO> deletePlayer(@PathVariable Long id) {
        SuccessResponseDTO response = playerService.deletePlayer(id);
        return ResponseEntity.ok(response);
    }

    /**
     * SchvĂˇlĂ­ hrĂˇÄŤe (zmÄ›nĂ­ jeho stav na APPROVED).
     */
    @PutMapping("/{id}/approve")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SuccessResponseDTO> approvePlayer(@PathVariable Long id) {
        SuccessResponseDTO response = playerService.approvePlayer(id);
        return ResponseEntity.ok(response);
    }

    /**
     * ZamĂ­tne hrĂˇÄŤe (zmÄ›nĂ­ jeho stav na REJECTED).
     */
    @PutMapping("/{id}/reject")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SuccessResponseDTO> rejectPlayer(@PathVariable Long id) {
        SuccessResponseDTO response = playerService.rejectPlayer(id);
        return ResponseEntity.ok(response);
    }

    /**
     * ZmÄ›nĂ­ pĹ™iĹ™azenĂ­ hrĂˇÄŤe k aplikaÄŤnĂ­mu uĹľivateli.
     *
     * Operace je vyhrazena pouze pro roli ADMIN.
     *
     * @param playerId ID hrĂˇÄŤe, kterĂ©mu mĂˇ bĂ˝t zmÄ›nÄ›n pĹ™iĹ™azenĂ˝ uĹľivatel
     * @param request  request obsahujĂ­cĂ­ ID novĂ©ho uĹľivatele
     */
    @PostMapping("/{playerId}/change-user")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<String> changePlayerUser(
            @PathVariable Long playerId,
            @RequestBody ChangePlayerUserRequest request
    ) {
        playerService.changePlayerUser(playerId, request.getNewUserId());
        return ResponseEntity.ok(
                "HrĂˇÄŤ s id: " + playerId + " byl ĂşspÄ›ĹˇnÄ› pĹ™iĹ™azen uĹľivateli s ID: " + request.getNewUserId()
        );
    }

    // =========================================================
    //  USER â€“ HRĂÄŚI PĹIHLĂĹ ENĂ‰HO UĹ˝IVATELE (/me)
    // =========================================================

    /**
     * VytvoĹ™Ă­ novĂ©ho hrĂˇÄŤe pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     */
    @PostMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public PlayerDTO createMyPlayer(
            @Valid @RequestBody PlayerDTO playerDTO,
            Authentication authentication
    ) {
        String email = authentication.getName();
        return playerService.createPlayerForUser(playerDTO, email);
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech hrĂˇÄŤĹŻ patĹ™Ă­cĂ­ch pĹ™ihlĂˇĹˇenĂ©mu uĹľivateli.
     */
    @GetMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public List<PlayerDTO> getMyPlayers(Authentication authentication) {
        String email = authentication.getName();
        return playerService.getPlayersByUser(email);
    }

    /**
     * Aktualizuje Ăşdaje aktuĂˇlnÄ› zvolenĂ©ho hrĂˇÄŤe.
     *
     * VyĹľaduje, aby mÄ›l uĹľivatel nastavenĂ©ho â€žaktuĂˇlnĂ­ho hrĂˇÄŤeâ€ś.
     */
    @PutMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public PlayerDTO updateMyCurrentPlayer(@Valid @RequestBody PlayerDTO dto) {
        currentPlayerService.requireCurrentPlayer();
        Long currentPlayerId = currentPlayerService.getCurrentPlayerId();
        return playerService.updatePlayer(currentPlayerId, dto);
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\PlayerInactivityPeriodController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.PlayerInactivityPeriodDTO;
import cz.phsoft.hokej.models.services.PlayerInactivityPeriodService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro administraci obdobĂ­ neaktivity hrĂˇÄŤĹŻ.
 * <p>
 * ObdobĂ­ neaktivity slouĹľĂ­ k evidenci ÄŤasovĂ˝ch ĂşsekĹŻ, ve kterĂ˝ch
 * hrĂˇÄŤ doÄŤasnÄ› nevystupuje v zĂˇpasech (napĹ™. zranÄ›nĂ­, dovolenĂˇ).
 * <p>
 * Endpoints jsou urÄŤeny pro role ADMIN a MANAGER (dle typu operace)
 * a umoĹľĹujĂ­ kompletnĂ­ sprĂˇvu zĂˇznamĹŻ o neaktivitÄ›.
 *
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link PlayerInactivityPeriodService}.
 */
@RestController
@RequestMapping("/api/inactivity/admin")
public class PlayerInactivityPeriodController {

    private final PlayerInactivityPeriodService service;

    public PlayerInactivityPeriodController(PlayerInactivityPeriodService service) {
        this.service = service;
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech zĂˇznamĹŻ o neaktivitÄ› hrĂˇÄŤĹŻ.
     *
     * @return seznam obdobĂ­ neaktivity
     */
    @GetMapping("/all")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<PlayerInactivityPeriodDTO> getAll() {
        return service.getAll();
    }

    /**
     * VrĂˇtĂ­ detail zĂˇznamu o neaktivitÄ› podle jeho ID.
     *
     * @param id ID zĂˇznamu o neaktivitÄ›
     * @return detail obdobĂ­ neaktivity
     */
    @GetMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public ResponseEntity<PlayerInactivityPeriodDTO> getById(@PathVariable Long id) {
        PlayerInactivityPeriodDTO dto = service.getById(id);
        return ResponseEntity.ok(dto);
    }

    /**
     * VrĂˇtĂ­ vĹˇechna obdobĂ­ neaktivity pro konkrĂ©tnĂ­ho hrĂˇÄŤe.
     *
     * @param playerId ID hrĂˇÄŤe
     * @return seznam obdobĂ­ neaktivity hrĂˇÄŤe
     */
    @GetMapping("/player/{playerId}")
    @PreAuthorize("hasRole('ADMIN') or hasRole('MANAGER')")
    public List<PlayerInactivityPeriodDTO> getByPlayer(@PathVariable Long playerId) {
        return service.getByPlayer(playerId);
    }

    /**
     * VytvoĹ™Ă­ novĂ˝ zĂˇznam o neaktivitÄ› hrĂˇÄŤe.
     * <p>
     * Operace je vyhrazena pouze pro administrĂˇtora.
     *
     * @param dto data obdobĂ­ neaktivity
     * @return vytvoĹ™enĂ˝ zĂˇznam o neaktivitÄ›
     */
    @PostMapping
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<PlayerInactivityPeriodDTO> create(
            @Valid @RequestBody PlayerInactivityPeriodDTO dto) {

        PlayerInactivityPeriodDTO created = service.create(dto);
        return ResponseEntity.ok(created);
    }

    /**
     * Aktualizuje existujĂ­cĂ­ zĂˇznam o neaktivitÄ› hrĂˇÄŤe.
     * <p>
     * Operace je vyhrazena pouze pro administrĂˇtora.
     *
     * @param id  ID zĂˇznamu o neaktivitÄ›
     * @param dto aktualizovanĂˇ data obdobĂ­ neaktivity
     * @return aktualizovanĂ˝ zĂˇznam o neaktivitÄ›
     */
    @PutMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<PlayerInactivityPeriodDTO> update(
            @PathVariable Long id,
            @Valid @RequestBody PlayerInactivityPeriodDTO dto) {

        PlayerInactivityPeriodDTO updated = service.update(id, dto);
        return ResponseEntity.ok(updated);
    }

    /**
     * OdstranĂ­ zĂˇznam o neaktivitÄ› hrĂˇÄŤe.
     * <p>
     * Operace je vyhrazena pouze pro administrĂˇtora.
     *
     * @param id ID zĂˇznamu o neaktivitÄ›
     * @return HTTP 204 No Content
     */
    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<Void> delete(@PathVariable Long id) {
        service.delete(id);
        return ResponseEntity.noContent().build();
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\SeasonController.java
-----

package cz.phsoft.hokej.controllers;

import cz.phsoft.hokej.models.dto.SeasonDTO;
import cz.phsoft.hokej.models.dto.mappers.SeasonMapper;
import cz.phsoft.hokej.models.services.CurrentSeasonService;
import cz.phsoft.hokej.models.services.SeasonService;
import jakarta.validation.Valid;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * REST controller pro sprĂˇvu sezĂłn.
 *
 * ZajiĹˇĹĄuje:
 * <ul>
 *     <li>administraci sezĂłn (CRUD, nastavenĂ­ aktivnĂ­ sezĂłny) pro roli ADMIN,</li>
 *     <li>prĂˇci s â€žaktuĂˇlnĂ­ sezĂłnouâ€ś pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele (/me).</li>
 * </ul>
 *
 * VeĹˇkerĂˇ business logika je delegovĂˇna do {@link SeasonService}
 * a {@link CurrentSeasonService}.
 */
@RestController
@RequestMapping("/api/seasons")
public class SeasonController {

    private final SeasonService seasonService;
    private final SeasonMapper seasonMapper;
    private final CurrentSeasonService currentSeasonService;

    public SeasonController(SeasonService seasonService,
                            SeasonMapper seasonMapper,
                            CurrentSeasonService currentSeasonService) {
        this.seasonService = seasonService;
        this.seasonMapper = seasonMapper;
        this.currentSeasonService = currentSeasonService;
    }

    // =========================================================
    //  ADMIN â€“ GLOBĂLNĂŤ SPRĂVA SEZĂ“N
    // =========================================================

    /**
     * VytvoĹ™Ă­ novou sezĂłnu.
     *
     * @param seasonDTO data novĂ© sezĂłny
     * @return vytvoĹ™enĂˇ sezĂłna
     */
    @PostMapping
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SeasonDTO> createSeason(
            @Valid @RequestBody SeasonDTO seasonDTO) {

        SeasonDTO created = seasonService.createSeason(seasonDTO);
        return ResponseEntity.status(HttpStatus.CREATED).body(created);
    }

    /**
     * Aktualizuje existujĂ­cĂ­ sezĂłnu.
     *
     * @param id        ID sezĂłny
     * @param seasonDTO aktualizovanĂˇ data sezĂłny
     * @return aktualizovanĂˇ sezĂłna
     */
    @PutMapping("/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SeasonDTO> updateSeason(
            @PathVariable Long id,
            @Valid @RequestBody SeasonDTO seasonDTO
    ) {
        SeasonDTO updated = seasonService.updateSeason(id, seasonDTO);
        return ResponseEntity.ok(updated);
    }

    /**
     * VrĂˇtĂ­ seznam vĹˇech sezĂłn v systĂ©mu.
     *
     * Tady mĹŻĹľeĹˇ nechat jen ADMIN, nebo klidnÄ› vĹˇem pĹ™ihlĂˇĹˇenĂ˝m.
     * AktuĂˇlnÄ› omezeno na ADMIN kvĹŻli pĹŻvodnĂ­mu chovĂˇnĂ­.
     */
    @GetMapping
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<List<SeasonDTO>> getAllSeasonsAdmin() {
        List<SeasonDTO> seasons = seasonService.getAllSeasons();
        return ResponseEntity.ok(seasons);
    }

    /**
     * VrĂˇtĂ­ aktuĂˇlnÄ› aktivnĂ­ globĂˇlnĂ­ sezĂłnu.
     */
    @GetMapping("/active")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SeasonDTO> getActiveSeason() {
        SeasonDTO dto = seasonMapper.toDTO(seasonService.getActiveSeason());
        return ResponseEntity.ok(dto);
    }

    /**
     * NastavĂ­ zadanou sezĂłnu jako globĂˇlnÄ› aktivnĂ­.
     *
     * @param id ID sezĂłny, kterĂˇ mĂˇ bĂ˝t nastavena jako aktivnĂ­
     * @return novÄ› aktivnĂ­ sezĂłna
     */
    @PutMapping("/{id}/active")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<SeasonDTO> setActiveSeason(@PathVariable Long id) {
        seasonService.setActiveSeason(id);
        SeasonDTO active = seasonMapper.toDTO(seasonService.getActiveSeason());
        return ResponseEntity.ok(active);
    }

    // =========================================================
    //  USER â€“ PRĂCE S â€žMOJĂŤâ€ś SEZĂ“NOU (/me)
    // =========================================================

    /**
     * VrĂˇtĂ­ vĹˇechny sezĂłny pro ĂşÄŤely vĂ˝bÄ›ru na frontendu.
     *
     * Toto je user-friendly varianta (pĹŻvodnĂ­ /api/seasons/me GET).
     */
    @GetMapping("/me")
    @PreAuthorize("isAuthenticated()")
    public List<SeasonDTO> getAllSeasonsForUser() {
        return seasonService.getAllSeasons();
    }

    /**
     * VrĂˇtĂ­ sezĂłnu, kterĂˇ je aktuĂˇlnÄ› vybranĂˇ pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     * Pokud nenĂ­ vybranĂˇ, vrĂˇtĂ­ null (nebo default dle CurrentSeasonService).
     */
    @GetMapping("/me/current")
    @PreAuthorize("isAuthenticated()")
    public SeasonDTO getCurrentSeasonForUser() {
        Long id = currentSeasonService.getCurrentSeasonIdOrDefault();
        return (id != null) ? seasonService.getSeasonById(id) : null;
    }

    /**
     * NastavĂ­ aktuĂˇlnĂ­ sezĂłnu pro pĹ™ihlĂˇĹˇenĂ©ho uĹľivatele.
     *
     * @param seasonId ID sezĂłny, kterĂˇ mĂˇ bĂ˝t nastavena jako current pro uĹľivatele
     */
    @PostMapping("/me/current/{seasonId}")
    @PreAuthorize("isAuthenticated()")
    public void setCurrentSeasonForUser(@PathVariable Long seasonId) {
        // jednoduchĂˇ validace â€“ ovÄ›Ĺ™Ă­me, Ĺľe sezĂłna existuje
        seasonService.getSeasonById(seasonId);
        currentSeasonService.setCurrentSeasonId(seasonId);
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\TestController.java
-----

package cz.phsoft.hokej.controllers;

import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/test")
@PreAuthorize("hasRole('ADMIN')")
public class TestController {

    @GetMapping
    public String hello() {
        return "Backend je online!";
    }
}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\TestEmailController.java
-----

package cz.phsoft.hokej.controllers;


import cz.phsoft.hokej.models.services.email.EmailService;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/email/test")
public class TestEmailController {
    private final EmailService emailService;

    public TestEmailController(EmailService emailService) {
        this.emailService = emailService;
    }

    @PostMapping("/send-mail")
    public String sendTestMail() {
        emailService.sendSimpleEmail(
                "petrhlista@seznam.cz",
                "APP - TestovacĂ­ email",
                "Ahoj, toto je test z backendu."
        );
        return "Email odeslĂˇn";
    }

}



-----
# Soubor: C:\Projekty Práce\StaraGarda\backend\src\main\java\cz\phsoft\hokej\controllers\TestSmsController.java
-----

/*
package cz.phsoft.hokej.controllers;


import cz.phsoft.hokej.models.services.sms.SmsTextBeeService;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestSmsController {

    private final SmsTextBeeService smsTextBeeService;

    public TestSmsController(SmsTextBeeService smsTextBeeService) {
        this.smsTextBeeService = smsTextBeeService;
    }

    /**
     * TestovacĂ­ endpoint pro odeslĂˇnĂ­ SMS na testovacĂ­ ÄŤĂ­slo.
     * Zavolej: GET /api/test-sms
     */
/*
    @GetMapping("/api/test-sms")
    public String sendTestSms() {
        smsTextBeeService.sendSms("+420776609956", "testovacĂ­ sms app-sg");
        return "SMS byla odeslĂˇna na testovacĂ­ ÄŤĂ­slo +420776609956";
    }
}

        */

